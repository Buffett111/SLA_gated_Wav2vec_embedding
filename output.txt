 ______                 ______            _
(_____ \               (_____ \          | |
 _____) ) _   _  ____   _____) )___    __| |
|  __  / | | | ||  _ \ |  ____// _ \  / _  |
| |  \ \ | |_| || | | || |    | |_| |( (_| |
|_|   |_||____/ |_| |_||_|     \___/  \____|

For detailed documentation and guides, please visit:
https://docs.runpod.io/ and https://blog.runpod.io/


root@d7c44325ce82:/workspace# ./runW2V.sh
Resolving data files: 100%|███████████████████████████████████████████████████████████████████████████| 28/28 [00:00<00:00, 475467.66it/s]
Resolving data files: 100%|██████████████████████████████████████████████████████████████████████████████| 28/28 [00:00<00:00, 143.43it/s]
Loading dataset shards: 100%|██████████████████████████████████████████████████████████████████████████| 28/28 [00:00<00:00, 21780.51it/s]
/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/transformers/configuration_utils.py:312: UserWarning: Passing `gradient_checkpoint
ing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instea
d, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
[Stage1][Epoch 1/5] triplet_loss=0.2042
[Stage1][Epoch 2/5] triplet_loss=0.2000
[Stage1][Epoch 3/5] triplet_loss=0.1989
[Stage1][Epoch 4/5] triplet_loss=0.1989
[Stage1][Epoch 5/5] triplet_loss=0.1975
Resolving data files: 100%|███████████████████████████████████████████████████████████████████████████| 28/28 [00:00<00:00, 690826.54it/s]
Resolving data files: 100%|███████████████████████████████████████████████████████████████████████████████| 28/28 [00:00<00:00, 63.65it/s]
Loading dataset shards: 100%|██████████████████████████████████████████████████████████████████████████| 28/28 [00:00<00:00, 33854.28it/s]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/sandi_pipeline/train.py", line 322, in <module>
    train_all()
  File "/workspace/sandi_pipeline/train.py", line 318, in train_all
    stage2_train_regressor(cfg, backbone, adapter, aggregator, ds_pack)
  File "/workspace/sandi_pipeline/train.py", line 235, in stage2_train_regressor
    frames = backbone(dummy["input_values"], attention_mask=dummy.get("attention_mask"))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/sandi_pipeline/model.py", line 33, in forward
    out = self.model(input_values=input_values, attention_mask=attention_mask)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1808, in forward
    extract_features = self.feature_extractor(input_values)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 463, in forward
    hidden_states = conv_layer(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 360, in forward
    hidden_states = self.conv(hidden_states)
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 371, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/miniconda3/envs/Phi4/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 366, in _conv_forward
    return F.conv1d(
           ^^^^^^^^^
RuntimeError: Expected 2D (unbatched) or 3D (batched) input to conv1d, but got input of size: [1, 1, 1, 16000]
root@d7c44325ce82:/workspace# tmux capture-pane -pS - > output.txt

